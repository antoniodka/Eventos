<!DOCTYPE html><html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Organizador de Eventos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">  <style>
    :root {
      --primary: #2c3e50;
      --accent: #3498db;
      --success: #27ae60;
      --danger: #e74c3c;
      --bg: #f8f9fa;
      --white: #fff;
      --radius: 12px;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background: var(--bg);
    }
    header {
      background: var(--primary);
      color: var(--white);
      padding: 1rem;
      text-align: center;
      font-size: 1.4rem;
      font-weight: bold;
    }
    main {
      padding: 1rem;
      max-width: 700px;
      margin: auto;
    }
    button {
      width: 100%;
      padding: 1rem;
      font-size: 1.1rem;
      font-weight: 600;
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      margin-bottom: 0.8rem;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transition: transform 0.1s ease;
    }
    #addEventBtn { background: var(--accent); color: var(--white); }
    #copyAllBtn { background: var(--success); color: white; }
    #sortByEventBtn, #sortByMountBtn { background: #888; color: white; }
    button:active { transform: scale(0.98); }
    .event {
      background: var(--white);
      border-radius: var(--radius);
      padding: 1rem;
      margin-bottom: 1rem;
      box-shadow: 0 1px 5px rgba(0,0,0,0.1);
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 1rem;
      flex-wrap: wrap;
    }
    .event-info {
      flex: 1 1 65%;
    }
    .event-actions {
      flex: 0 1 30%;
      display: flex;
      flex-direction: row;
      justify-content: flex-end;
      gap: 0.4rem;
    }
    .event-actions button {
      padding: 0.3rem 0.6rem;
      font-size: 0.9rem;
      border-radius: 6px;
      border: none;
      background: var(--accent);
      color: white;
      white-space: nowrap;
    }
    .event-actions button:hover {
      background: var(--primary);
    }
    dialog input, dialog label {
      width: 100%;
      margin-bottom: 0.6rem;
      font-size: 1rem;
    }
    dialog input {
      padding: 0.6rem;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body><header>üìÖ Organizador de Eventos</header>
<main>
  <button id="addEventBtn">‚ûï Agregar Evento</button>
  <button id="copyAllBtn">üìã Copiar Todo</button>
  <button id="sortByEventBtn">Ordenar por Fecha de Evento</button>
  <button id="sortByMountBtn">Ordenar por Fecha de Montaje</button>
  <div id="eventList"></div>
</main><dialog id="eventDialog">
  <form id="eventForm">
    <input type="hidden" id="eventId">
    <label>Fecha del Evento</label>
    <input type="date" id="fechaEvento" required>
    <label>Hora del Evento</label>
    <input type="time" id="horaEvento" required>
    <label>Fecha de Montaje</label>
    <input type="date" id="fechaMontaje" required>
    <label>Hora de Montaje</label>
    <input type="time" id="horaMontaje" required>
    <label>Lugar</label>
    <input type="text" id="lugar" required>
    <div style="text-align: right;">
      <button type="button" id="saveBtn">Guardar</button>
      <button type="button" id="cancelBtn">Cancelar</button>
    </div>
  </form>
</dialog><script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js';
import { getFirestore, collection, addDoc, getDocs, updateDoc, deleteDoc, doc, orderBy, query } from 'https://www.gstatic.com/firebasejs/11.9.1/firebase-firestore.js';

const firebaseConfig = {
  apiKey: "AIzaSyDl7eqNL5s9El_TaZpTE6i7-PwgubbtPkM",
  authDomain: "eventos-bc9d1.firebaseapp.com",
  projectId: "eventos-bc9d1",
  storageBucket: "eventos-bc9d1.appspot.com",
  messagingSenderId: "831523591170",
  appId: "1:831523591170:web:c3e6b3367df0d47cf3c31b",
  measurementId: "G-TFN83DR6C0"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const form = document.getElementById('eventForm');
const dialog = document.getElementById('eventDialog');
const eventList = document.getElementById('eventList');
let sortBy = 'fechaEvento';

function formatearFecha(fechaStr) {
  const dias = ['domingo','lunes','martes','mi√©rcoles','jueves','viernes','s√°bado'];
  const fecha = new Date(fechaStr + 'T00:00:00');
  return `${dias[fecha.getDay()]}, ${fecha.toLocaleDateString('es-CO')}`;
}

document.getElementById('addEventBtn').onclick = () => {
  form.reset();
  document.getElementById('eventId').value = '';
  dialog.showModal();
};

document.getElementById('cancelBtn').onclick = () => dialog.close();

document.getElementById('saveBtn').onclick = async () => {
  const fechaEv = new Date(document.getElementById('fechaEvento').value);
  const fechaMont = new Date(document.getElementById('fechaMontaje').value);

  if (fechaMont > fechaEv) {
    alert("‚ö†Ô∏è La fecha de montaje no puede ser posterior a la fecha del evento.");
    return;
  }

  const evento = {
    fechaEvento: document.getElementById('fechaEvento').value,
    horaEvento: document.getElementById('horaEvento').value,
    fechaMontaje: document.getElementById('fechaMontaje').value,
    horaMontaje: document.getElementById('horaMontaje').value,
    lugar: document.getElementById('lugar').value
  };

  const id = document.getElementById('eventId').value;
  if (id) {
    await updateDoc(doc(db, 'eventos', id), evento);
  } else {
    await addDoc(collection(db, 'eventos'), evento);
  }

  dialog.close();
  cargarEventos();
};

document.getElementById('sortByEventBtn').onclick = () => {
  sortBy = 'fechaEvento';
  cargarEventos();
};

document.getElementById('sortByMountBtn').onclick = () => {
  sortBy = 'fechaMontaje';
  cargarEventos();
};

async function cargarEventos() {
  eventList.innerHTML = '';
  const q = query(collection(db, 'eventos'), orderBy(sortBy));
  const res = await getDocs(q);
  res.forEach(docSnap => {
    const e = docSnap.data();
    const div = document.createElement('div');
    div.className = 'event';
    div.innerHTML = `
  <div class="event-info">
    <strong>${formatearFecha(e.fechaEvento)} ${e.horaEvento}</strong><br>
    <em>Montaje:</em> ${formatearFecha(e.fechaMontaje)} ${e.horaMontaje}<br>
    <em>Lugar:</em> ${e.lugar}
  </div>
  <div class="event-actions">
    <button onclick="editar('${docSnap.id}')">‚úèÔ∏è</button>
    <button onclick="eliminar('${docSnap.id}')">üóëÔ∏è</button>
  </div>
`;
    eventList.appendChild(div);
  });
}

window.editar = async (id) => {
  const d = await getDocs(collection(db, 'eventos'));
  d.forEach(docSnap => {
    if (docSnap.id === id) {
      const e = docSnap.data();
      document.getElementById('eventId').value = id;
      document.getElementById('fechaEvento').value = e.fechaEvento;
      document.getElementById('horaEvento').value = e.horaEvento;
      document.getElementById('fechaMontaje').value = e.fechaMontaje;
      document.getElementById('horaMontaje').value = e.horaMontaje;
      document.getElementById('lugar').value = e.lugar;
      dialog.showModal();
    }
  });
};

window.eliminar = async (id) => {
  if (confirm('¬øEliminar este evento?')) {
    await deleteDoc(doc(db, 'eventos', id));
    cargarEventos();
  }
};

document.getElementById('copyAllBtn').onclick = async () => {
  const q = query(collection(db, 'eventos'), orderBy(sortBy));
  const res = await getDocs(q);
  let texto = '';
  res.forEach(docSnap => {
    const e = docSnap.data();
    texto += `üìç Evento\nüìÖ Evento: ${formatearFecha(e.fechaEvento)} ${e.horaEvento}\nüîß Montaje: ${formatearFecha(e.fechaMontaje)} ${e.horaMontaje}\nüìå Lugar: ${e.lugar}\n------------------------------\n\n`;
  });
  await navigator.clipboard.writeText(texto);
  alert("‚úÖ Copiado al portapapeles");
};

cargarEventos();
</script></body>
</html>